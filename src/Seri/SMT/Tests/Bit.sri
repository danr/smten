
module Seri.SMT.Tests.Bit where

import Seri.Lib.Prelude
import Seri.Lib.Bit
import Seri.SMT.SMT

bityx :: Bit #(2+3)
bityx = 15

main :: Query (Answer (Bit#3, Bit #2, Bit #3))
main = do
    -- x is 'b111
    x <- free
    assert (((x :: Bit #3) + 1) == 0)

    -- y is 'b01
    y <- free
    assert (bv_concat y x == bityx)

    -- z is 'b011
    z <- free
    assert (z == bv_extract bityx 2)

    query (x, y, z)

