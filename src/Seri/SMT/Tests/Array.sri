
module Seri.SMT.Tests.Array where {

import Seri.Lib.Prelude;
import Seri.SMT.Array;
import Seri.SMT.SMT;

arr :: SMTArray Integer;
arr = smta_upd (smta_upd (smta_upd (smta_new 3) 0 42) 1 12) 2 19;

arrayworks :: Bool;
arrayworks = and [
    42 == smta_sub arr 0,
    12 == smta_sub arr 1,
    19 == smta_sub arr 2];

main :: Query (Answer (Integer, Integer));
main = do {
    assert arrayworks;

    x <- free;
    assert (arr == (smta_upd arr 1 x));
    
    arr2 <- smta_free 3;
    --arr2 <- free;
    assert (arr2 == arr);

    y <- free;
    assert (y == smta_sub arr2 2);

    query (x, y);
};

}

