
module Smten.SMT.Tests.Test (symtest, symtesteq) where

import Smten.SMT.Symbolic
import Smten.Tests.Test

symtesteq :: (Eq a) => String -> Maybe a -> [Solver] -> Symbolic a -> IO ()
symtesteq nm wnt slv q = symtest nm ((==) wnt) slv q

symtest :: String -> (Maybe a -> Bool) -> [Solver] -> Symbolic a -> IO ()
symtest nm tst slv q = mapM_ (symtest1 nm tst q) slv

symtest1 :: String -> (Maybe a -> Bool) -> Symbolic a -> Solver -> IO ()
symtest1 nm tst q slv = do
    let dbgout = "build/test/SYMTEST." ++ nm ++ "." ++ show slv ++ ".dbg"
    got <- runSymbolic slv (Just dbgout) q
    test (nm ++ "." ++ show slv) (tst got)

